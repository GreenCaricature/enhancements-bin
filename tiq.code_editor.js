window.csm = window.csm || {};
csm.dateFormat=csm.dateFormat||function(){var dateFormat=function(){var t=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,e=/(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)/g,a=/[^-+\dA-Z]/g,m=function(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t};return function(d,y,r){var n=dateFormat;if(1!==arguments.length||"[object String]"!==Object.prototype.toString.call(d)||/\d/.test(d)||(y=d,d=void 0),d=d?new Date(d):new Date,isNaN(d))throw SyntaxError("invalid date");y=String(n.masks[y]||y||n.masks["default"]),"UTC:"===y.slice(0,4)&&(y=y.slice(4),r=!0);var s=r?"getUTC":"get",i=d[s+"Date"](),o=d[s+"Day"](),M=d[s+"Month"](),u=d[s+"FullYear"](),l=d[s+"Hours"](),T=d[s+"Minutes"](),h=d[s+"Seconds"](),c=d[s+"Milliseconds"](),g=r?0:d.getTimezoneOffset(),D={d:i,dd:m(i),ddd:n.i18n.dayNames[o],dddd:n.i18n.dayNames[o+7],m:M+1,mm:m(M+1),mmm:n.i18n.monthNames[M],mmmm:n.i18n.monthNames[M+12],yy:String(u).slice(2),yyyy:u,h:l%12||12,hh:m(l%12||12),H:l,HH:m(l),M:T,MM:m(T),s:h,ss:m(h),l:m(c,3),L:m(c>99?Math.round(c/10):c),t:12>l?"a":"p",tt:12>l?"am":"pm",T:12>l?"A":"P",TT:12>l?"AM":"PM",Z:r?"UTC":(String(d).match(e)||[""]).pop().replace(a,""),o:(g>0?"-":"+")+m(100*Math.floor(Math.abs(g)/60)+Math.abs(g)%60,4),S:["th","st","nd","rd"][i%10>3?0:(i%100-i%10!==10)*i%10]};return y.replace(t,function(t){return t in D?D[t]:t.slice(1,t.length-1)})}}();dateFormat.masks={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",modisoDateTime:"yyyy-mm-ddHMS",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",modDate:"yyyy-mm-dd",modFileDate:"yyyymmdd-HHMMss"},dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},Date.prototype.format=function(t,e){return dateFormat(this,t,e)};return dateFormat}();
(function(exp) {
  function getCodeEditor() {
  // javascript beautify
  var jsb=function(){require=function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module,exports){(function(global){(function(){function mergeOpts(allOptions,targetType){var finalOpts={};var name;for(name in allOptions)if(name!==targetType)finalOpts[name]=allOptions[name];if(targetType in allOptions)for(name in allOptions[targetType])finalOpts[name]=allOptions[targetType][name];return finalOpts}var lineBreak=/\r\n|[\n\r\u2028\u2029]/;var allLineBreaks=new RegExp(lineBreak.source,"g");function css_beautify(source_text,options){options=options||{};options=mergeOpts(options,"css");source_text=source_text||"";var newlinesFromLastWSEat=0;var indentSize=options.indent_size?parseInt(options.indent_size,10):4;var indentCharacter=options.indent_char||" ";var preserve_newlines=options.preserve_newlines===undefined?false:options.preserve_newlines;var selectorSeparatorNewline=options.selector_separator_newline===undefined?true:options.selector_separator_newline;var end_with_newline=options.end_with_newline===undefined?false:options.end_with_newline;var newline_between_rules=options.newline_between_rules===undefined?true:options.newline_between_rules;var space_around_combinator=options.space_around_combinator===undefined?false:options.space_around_combinator;space_around_combinator=space_around_combinator||(options.space_around_selector_separator===undefined?false:options.space_around_selector_separator);var eol=options.eol?options.eol:"auto";if(options.indent_with_tabs){indentCharacter="\t";indentSize=1}if(eol==="auto"){eol="\n";if(source_text&&lineBreak.test(source_text||""))eol=source_text.match(lineBreak)[0]}eol=eol.replace(/\\r/,"\r").replace(/\\n/,"\n");source_text=source_text.replace(allLineBreaks,"\n");var whiteRe=/^\s+$/;var pos=-1,ch;var parenLevel=0;function next(){ch=source_text.charAt(++pos);return ch||""}function peek(skipWhitespace){var result="";var prev_pos=pos;if(skipWhitespace)eatWhitespace();result=source_text.charAt(pos+1)||"";pos=prev_pos-1;next();return result}function eatString(endChars){var start=pos;while(next())if(ch==="\\")next();else if(endChars.indexOf(ch)!==-1)break;else if(ch==="\n")break;return source_text.substring(start,pos+1)}function peekString(endChar){var prev_pos=pos;var str=eatString(endChar);pos=prev_pos-1;next();return str}function eatWhitespace(preserve_newlines_local){var result=0;while(whiteRe.test(peek())){next();if(ch==="\n"&&preserve_newlines_local&&preserve_newlines){print.newLine(true);result++}}newlinesFromLastWSEat=result;return result}function skipWhitespace(){var result="";if(ch&&whiteRe.test(ch))result=ch;while(whiteRe.test(next()))result+=ch;return result}function eatComment(singleLine){var start=pos;singleLine=peek()==="/";next();while(next())if(!singleLine&&ch==="*"&&peek()==="/"){next();break}else if(singleLine&&ch==="\n")return source_text.substring(start,pos);return source_text.substring(start,pos)+ch}function lookBack(str){return source_text.substring(pos-str.length,pos).toLowerCase()===str}function foundNestedPseudoClass(){var openParen=0;for(var i=pos+1;i<source_text.length;i++){var ch=source_text.charAt(i);if(ch==="{")return true;else if(ch==="(")openParen+=1;else if(ch===")"){if(openParen===0)return false;openParen-=1}else if(ch===";"||ch==="}")return false}return false}var basebaseIndentString=source_text.match(/^[\t ]*/)[0];var singleIndent=new Array(indentSize+1).join(indentCharacter);var indentLevel=0;var nestedLevel=0;function indent(){indentLevel++;basebaseIndentString+=singleIndent}function outdent(){indentLevel--;basebaseIndentString=basebaseIndentString.slice(0,-indentSize)}var print={};print["{"]=function(ch){print.singleSpace();output.push(ch);if(!eatWhitespace(true))print.newLine()};print["}"]=function(newline){if(newline)print.newLine();output.push("}");if(!eatWhitespace(true))print.newLine()};print._lastCharWhitespace=function(){return whiteRe.test(output[output.length-1])};print.newLine=function(keepWhitespace){if(output.length){if(!keepWhitespace&&output[output.length-1]!=="\n")print.trim();else if(output[output.length-1]===basebaseIndentString)output.pop();output.push("\n");if(basebaseIndentString)output.push(basebaseIndentString)}};print.singleSpace=function(){if(output.length&&!print._lastCharWhitespace())output.push(" ")};print.preserveSingleSpace=function(){if(isAfterSpace)print.singleSpace()};print.trim=function(){while(print._lastCharWhitespace())output.pop()};var output=[];var insideRule=false;var insidePropertyValue=false;var enteringConditionalGroup=false;var top_ch="";var last_top_ch="";while(true){var whitespace=skipWhitespace();var isAfterSpace=whitespace!=="";var isAfterNewline=whitespace.indexOf("\n")!==-1;last_top_ch=top_ch;top_ch=ch;if(!ch)break;else if(ch==="/"&&peek()==="*"){var header=indentLevel===0;if(isAfterNewline||header)print.newLine();output.push(eatComment());print.newLine();if(header)print.newLine(true)}else if(ch==="/"&&peek()==="/"){if(!isAfterNewline&&last_top_ch!=="{")print.trim();print.singleSpace();output.push(eatComment());print.newLine()}else if(ch==="@"){print.preserveSingleSpace();if(peek()==="{")output.push(eatString("}"));else{output.push(ch);var variableOrRule=peekString(": ,;{}()[]/='\"");if(variableOrRule.match(/[ :]$/)){next();variableOrRule=eatString(": ").replace(/\s$/,"");output.push(variableOrRule);print.singleSpace()}variableOrRule=variableOrRule.replace(/\s$/,"");if(variableOrRule in css_beautify.NESTED_AT_RULE){nestedLevel+=1;if(variableOrRule in css_beautify.CONDITIONAL_GROUP_RULE)enteringConditionalGroup=true}}}else if(ch==="#"&&peek()==="{"){print.preserveSingleSpace();output.push(eatString("}"))}else if(ch==="{")if(peek(true)==="}"){eatWhitespace();next();print.singleSpace();output.push("{");print["}"](false);if(newlinesFromLastWSEat<2&&newline_between_rules&&indentLevel===0)print.newLine(true)}else{indent();print["{"](ch);if(enteringConditionalGroup){enteringConditionalGroup=false;insideRule=indentLevel>nestedLevel}else insideRule=indentLevel>=nestedLevel}else if(ch==="}"){outdent();print["}"](true);insideRule=false;insidePropertyValue=false;if(nestedLevel)nestedLevel--;if(newlinesFromLastWSEat<2&&newline_between_rules&&indentLevel===0)print.newLine(true)}else if(ch===":"){eatWhitespace();if((insideRule||enteringConditionalGroup)&&!(lookBack("&")||foundNestedPseudoClass())&&!lookBack("(")){output.push(":");if(!insidePropertyValue){insidePropertyValue=true;print.singleSpace()}}else{if(lookBack(" ")&&output[output.length-1]!==" ")output.push(" ");if(peek()===":"){next();output.push("::")}else output.push(":")}}else if(ch==='"'||ch==="'"){print.preserveSingleSpace();output.push(eatString(ch))}else if(ch===";"){insidePropertyValue=false;output.push(ch);if(!eatWhitespace(true))print.newLine()}else if(ch==="(")if(lookBack("url")){output.push(ch);eatWhitespace();if(next())if(ch!==")"&&ch!=='"'&&ch!=="'")output.push(eatString(")"));else pos--}else{parenLevel++;print.preserveSingleSpace();output.push(ch);eatWhitespace()}else if(ch===")"){output.push(ch);parenLevel--}else if(ch===","){output.push(ch);if(!eatWhitespace(true)&&selectorSeparatorNewline&&!insidePropertyValue&&parenLevel<1)print.newLine();else print.singleSpace()}else if((ch===">"||ch==="+"||ch==="~")&&!insidePropertyValue&&parenLevel<1)if(space_around_combinator){print.singleSpace();output.push(ch);print.singleSpace()}else{output.push(ch);eatWhitespace();if(ch&&whiteRe.test(ch))ch=""}else if(ch==="]")output.push(ch);else if(ch==="["){print.preserveSingleSpace();output.push(ch)}else if(ch==="="){eatWhitespace();output.push("=");if(whiteRe.test(ch))ch=""}else{print.preserveSingleSpace();output.push(ch)}}var sweetCode="";if(basebaseIndentString)sweetCode+=basebaseIndentString;sweetCode+=output.join("").replace(/[\r\n\t ]+$/,"");if(end_with_newline)sweetCode+="\n";if(eol!=="\n")sweetCode=sweetCode.replace(/[\n]/g,eol);return sweetCode}css_beautify.NESTED_AT_RULE={"@page":true,"@font-face":true,"@keyframes":true,"@media":true,"@supports":true,"@document":true};css_beautify.CONDITIONAL_GROUP_RULE={"@media":true,"@supports":true,"@document":true};if(typeof define==="function"&&define.amd)define([],function(){return{css_beautify:css_beautify}});else if(typeof exports!=="undefined")exports.css_beautify=css_beautify;else if(typeof window!=="undefined")window.css_beautify=css_beautify;else if(typeof global!=="undefined")global.css_beautify=css_beautify})()}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],2:[function(require,module,exports){(function(global){(function(){function ltrim(s){return s.replace(/^\s+/g,"")}function rtrim(s){return s.replace(/\s+$/g,"")}function mergeOpts(allOptions,targetType){var finalOpts={};var name;for(name in allOptions)if(name!==targetType)finalOpts[name]=allOptions[name];if(targetType in allOptions)for(name in allOptions[targetType])finalOpts[name]=allOptions[targetType][name];return finalOpts}var lineBreak=/\r\n|[\n\r\u2028\u2029]/;var allLineBreaks=new RegExp(lineBreak.source,"g");function style_html(html_source,options,js_beautify,css_beautify){var multi_parser,indent_inner_html,indent_body_inner_html,indent_head_inner_html,indent_size,indent_character,wrap_line_length,brace_style,unformatted,content_unformatted,preserve_newlines,max_preserve_newlines,indent_handlebars,wrap_attributes,wrap_attributes_indent_size,is_wrap_attributes_force,is_wrap_attributes_force_expand_multiline,is_wrap_attributes_force_aligned,end_with_newline,extra_liners,eol;options=options||{};options=mergeOpts(options,"html");if((options.wrap_line_length===undefined||parseInt(options.wrap_line_length,10)===0)&&(options.max_char!==undefined&&parseInt(options.max_char,10)!==0))options.wrap_line_length=options.max_char;indent_inner_html=options.indent_inner_html===undefined?false:options.indent_inner_html;indent_body_inner_html=options.indent_body_inner_html===undefined?true:options.indent_body_inner_html;indent_head_inner_html=options.indent_head_inner_html===undefined?true:options.indent_head_inner_html;indent_size=options.indent_size===undefined?4:parseInt(options.indent_size,10);indent_character=options.indent_char===undefined?" ":options.indent_char;brace_style=options.brace_style===undefined?"collapse":options.brace_style;wrap_line_length=parseInt(options.wrap_line_length,10)===0?32786:parseInt(options.wrap_line_length||250,10);unformatted=options.unformatted||["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","address","big","dt","ins","strike","tt"];content_unformatted=options.content_unformatted||["pre"];preserve_newlines=options.preserve_newlines===undefined?true:options.preserve_newlines;max_preserve_newlines=preserve_newlines?isNaN(parseInt(options.max_preserve_newlines,10))?32786:parseInt(options.max_preserve_newlines,10):0;indent_handlebars=options.indent_handlebars===undefined?false:options.indent_handlebars;wrap_attributes=options.wrap_attributes===undefined?"auto":options.wrap_attributes;wrap_attributes_indent_size=isNaN(parseInt(options.wrap_attributes_indent_size,10))?indent_size:parseInt(options.wrap_attributes_indent_size,10);is_wrap_attributes_force=wrap_attributes.substr(0,"force".length)==="force";is_wrap_attributes_force_expand_multiline=wrap_attributes==="force-expand-multiline";is_wrap_attributes_force_aligned=wrap_attributes==="force-aligned";end_with_newline=options.end_with_newline===undefined?false:options.end_with_newline;extra_liners=typeof options.extra_liners==="object"&&options.extra_liners?options.extra_liners.concat():typeof options.extra_liners==="string"?options.extra_liners.split(","):"head,body,/html".split(",");eol=options.eol?options.eol:"auto";if(options.indent_with_tabs){indent_character="\t";indent_size=1}if(eol==="auto"){eol="\n";if(html_source&&lineBreak.test(html_source||""))eol=html_source.match(lineBreak)[0]}eol=eol.replace(/\\r/,"\r").replace(/\\n/,"\n");html_source=html_source.replace(allLineBreaks,"\n");function Parser(){this.pos=0;this.token="";this.current_mode="CONTENT";this.tags={parent:"parent1",parentcount:1,parent1:""};this.tag_type="";this.token_text=this.last_token=this.last_text=this.token_type="";this.newlines=0;this.indent_content=indent_inner_html;this.indent_body_inner_html=indent_body_inner_html;this.indent_head_inner_html=indent_head_inner_html;this.Utils={whitespace:"\n\r\t ".split(""),single_token:options.void_elements||["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","?php","basefont","isindex"],extra_liners:extra_liners,in_array:function(what,arr){for(var i=0;i<arr.length;i++)if(what===arr[i])return true;return false}};this.is_whitespace=function(text){for(var n=0;n<text.length;n++)if(!this.Utils.in_array(text.charAt(n),this.Utils.whitespace))return false;return true};this.traverse_whitespace=function(){var input_char="";input_char=this.input.charAt(this.pos);if(this.Utils.in_array(input_char,this.Utils.whitespace)){this.newlines=0;while(this.Utils.in_array(input_char,this.Utils.whitespace)){if(preserve_newlines&&input_char==="\n"&&this.newlines<=max_preserve_newlines)this.newlines+=1;this.pos++;input_char=this.input.charAt(this.pos)}return true}return false};this.space_or_wrap=function(content){if(this.line_char_count>=this.wrap_line_length){this.print_newline(false,content);this.print_indentation(content);return true}else{this.line_char_count++;content.push(" ");return false}};this.get_content=function(){var input_char="",content=[],handlebarsStarted=0;while(this.input.charAt(this.pos)!=="<"||handlebarsStarted===2){if(this.pos>=this.input.length)return content.length?content.join(""):["","TK_EOF"];if(handlebarsStarted<2&&this.traverse_whitespace()){this.space_or_wrap(content);continue}input_char=this.input.charAt(this.pos);if(indent_handlebars){if(input_char==="{")handlebarsStarted+=1;else if(handlebarsStarted<2)handlebarsStarted=0;if(input_char==="}"&&handlebarsStarted>0)if(handlebarsStarted--===0)break;var peek3=this.input.substr(this.pos,3);if(peek3==="{{#"||peek3==="{{/")break;else if(peek3==="{{!")return[this.get_tag(),"TK_TAG_HANDLEBARS_COMMENT"];else if(this.input.substr(this.pos,2)==="{{")if(this.get_tag(true)==="{{else}}")break}this.pos++;this.line_char_count++;content.push(input_char)}return content.length?content.join(""):""};this.get_contents_to=function(name){if(this.pos===this.input.length)return["","TK_EOF"];var content="";var reg_match=new RegExp("</"+name+"\\s*>","igm");reg_match.lastIndex=this.pos;var reg_array=reg_match.exec(this.input);var end_script=reg_array?reg_array.index:this.input.length;if(this.pos<end_script){content=this.input.substring(this.pos,end_script);this.pos=end_script}return content};this.record_tag=function(tag){if(this.tags[tag+"count"]){this.tags[tag+"count"]++;this.tags[tag+this.tags[tag+"count"]]=this.indent_level}else{this.tags[tag+"count"]=1;this.tags[tag+this.tags[tag+"count"]]=this.indent_level}this.tags[tag+this.tags[tag+"count"]+"parent"]=this.tags.parent;this.tags.parent=tag+this.tags[tag+"count"]};this.retrieve_tag=function(tag){if(this.tags[tag+"count"]){var temp_parent=this.tags.parent;while(temp_parent){if(tag+this.tags[tag+"count"]===temp_parent)break;temp_parent=this.tags[temp_parent+"parent"]}if(temp_parent){this.indent_level=this.tags[tag+this.tags[tag+"count"]];this.tags.parent=this.tags[temp_parent+"parent"]}delete this.tags[tag+this.tags[tag+"count"]+"parent"];delete this.tags[tag+this.tags[tag+"count"]];if(this.tags[tag+"count"]===1)delete this.tags[tag+"count"];else this.tags[tag+"count"]--}};this.indent_to_tag=function(tag){if(!this.tags[tag+"count"])return;var temp_parent=this.tags.parent;while(temp_parent){if(tag+this.tags[tag+"count"]===temp_parent)break;temp_parent=this.tags[temp_parent+"parent"]}if(temp_parent)this.indent_level=this.tags[tag+this.tags[tag+"count"]]};this.get_tag=function(peek){var input_char="",content=[],comment="",space=false,first_attr=true,has_wrapped_attrs=false,tag_start,tag_end,tag_start_char,orig_pos=this.pos,orig_line_char_count=this.line_char_count,is_tag_closed=false,tail;peek=peek!==undefined?peek:false;do{if(this.pos>=this.input.length){if(peek){this.pos=orig_pos;this.line_char_count=orig_line_char_count}return content.length?content.join(""):["","TK_EOF"]}input_char=this.input.charAt(this.pos);this.pos++;if(this.Utils.in_array(input_char,this.Utils.whitespace)){space=true;continue}if(input_char==="'"||input_char==='"'){input_char+=this.get_unformatted(input_char);space=true}if(input_char==="=")space=false;tail=this.input.substr(this.pos-1);if(is_wrap_attributes_force_expand_multiline&&has_wrapped_attrs&&!is_tag_closed&&(input_char===">"||input_char==="/"))if(tail.match(/^\/?\s*>/)){space=false;is_tag_closed=true;this.print_newline(false,content);this.print_indentation(content)}if(content.length&&content[content.length-1]!=="="&&input_char!==">"&&space){var wrapped=this.space_or_wrap(content);var indentAttrs=wrapped&&input_char!=="/"&&!is_wrap_attributes_force;space=false;if(is_wrap_attributes_force&&input_char!=="/"){var force_first_attr_wrap=false;if(is_wrap_attributes_force_expand_multiline&&first_attr){var is_only_attribute=tail.match(/^\S*(="([^"]|\\")*")?\s*\/?\s*>/)!==null;force_first_attr_wrap=!is_only_attribute}if(!first_attr||force_first_attr_wrap){this.print_newline(false,content);this.print_indentation(content);indentAttrs=true}}if(indentAttrs){has_wrapped_attrs=true;var alignment_size=wrap_attributes_indent_size;if(is_wrap_attributes_force_aligned)alignment_size=content.indexOf(" ")+1;for(var count=0;count<alignment_size;count++)content.push(" ")}if(first_attr)for(var i=0;i<content.length;i++)if(content[i]===" "){first_attr=false;break}}if(indent_handlebars&&tag_start_char==="<")if(input_char+this.input.charAt(this.pos)==="{{"){input_char+=this.get_unformatted("}}");if(content.length&&content[content.length-1]!==" "&&content[content.length-1]!=="<")input_char=" "+input_char;space=true}if(input_char==="<"&&!tag_start_char){tag_start=this.pos-1;tag_start_char="<"}if(indent_handlebars&&!tag_start_char)if(content.length>=2&&content[content.length-1]==="{"&&content[content.length-2]==="{"){if(input_char==="#"||input_char==="/"||input_char==="!")tag_start=this.pos-3;else tag_start=this.pos-2;tag_start_char="{"}this.line_char_count++;content.push(input_char);if(content[1]&&(content[1]==="!"||content[1]==="?"||content[1]==="%")){content=[this.get_comment(tag_start)];break}if(indent_handlebars&&content[1]&&content[1]==="{"&&content[2]&&content[2]==="!"){content=[this.get_comment(tag_start)];break}if(indent_handlebars&&tag_start_char==="{"&&content.length>2&&content[content.length-2]==="}"&&content[content.length-1]==="}")break}while(input_char!==">");var tag_complete=content.join("");var tag_index;var tag_offset;if(tag_complete.indexOf(" ")!==-1)tag_index=tag_complete.indexOf(" ");else if(tag_complete.indexOf("\n")!==-1)tag_index=tag_complete.indexOf("\n");else if(tag_complete.charAt(0)==="{")tag_index=tag_complete.indexOf("}");else tag_index=tag_complete.indexOf(">");if(tag_complete.charAt(0)==="<"||!indent_handlebars)tag_offset=1;else tag_offset=tag_complete.charAt(2)==="#"?3:2;var tag_check=tag_complete.substring(tag_offset,tag_index).toLowerCase();if(tag_complete.charAt(tag_complete.length-2)==="/"||this.Utils.in_array(tag_check,this.Utils.single_token)){if(!peek)this.tag_type="SINGLE"}else if(indent_handlebars&&tag_complete.charAt(0)==="{"&&tag_check==="else"){if(!peek){this.indent_to_tag("if");this.tag_type="HANDLEBARS_ELSE";this.indent_content=true;this.traverse_whitespace()}}else if(this.is_unformatted(tag_check,unformatted)||this.is_unformatted(tag_check,content_unformatted)){comment=this.get_unformatted("</"+tag_check+">",tag_complete);content.push(comment);tag_end=this.pos-1;this.tag_type="SINGLE"}else if(tag_check==="script"&&(tag_complete.search("type")===-1||tag_complete.search("type")>-1&&tag_complete.search(/\b(text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect)/)>-1)){if(!peek){this.record_tag(tag_check);this.tag_type="SCRIPT"}}else if(tag_check==="style"&&(tag_complete.search("type")===-1||tag_complete.search("type")>-1&&tag_complete.search("text/css")>-1)){if(!peek){this.record_tag(tag_check);this.tag_type="STYLE"}}else if(tag_check.charAt(0)==="!"){if(!peek){this.tag_type="SINGLE";this.traverse_whitespace()}}else if(!peek){if(tag_check.charAt(0)==="/"){this.retrieve_tag(tag_check.substring(1));this.tag_type="END"}else{this.record_tag(tag_check);if(tag_check.toLowerCase()!=="html")this.indent_content=true;this.tag_type="START"}if(this.traverse_whitespace())this.space_or_wrap(content);if(this.Utils.in_array(tag_check,this.Utils.extra_liners)){this.print_newline(false,this.output);if(this.output.length&&this.output[this.output.length-2]!=="\n")this.print_newline(true,this.output)}}if(peek){this.pos=orig_pos;this.line_char_count=orig_line_char_count}return content.join("")};this.get_comment=function(start_pos){var comment="",delimiter=">",matched=false;this.pos=start_pos;var input_char=this.input.charAt(this.pos);this.pos++;while(this.pos<=this.input.length){comment+=input_char;if(comment.charAt(comment.length-1)===delimiter.charAt(delimiter.length-1)&&comment.indexOf(delimiter)!==-1)break;if(!matched&&comment.length<10)if(comment.indexOf("<![if")===0){delimiter="<![endif]>";matched=true}else if(comment.indexOf("<![cdata[")===0){delimiter="]]>";matched=true}else if(comment.indexOf("<![")===0){delimiter="]>";matched=true}else if(comment.indexOf("\x3c!--")===0){delimiter="--\x3e";matched=true}else if(comment.indexOf("{{!--")===0){delimiter="--}}";matched=true}else if(comment.indexOf("{{!")===0){if(comment.length===5&&comment.indexOf("{{!--")===-1){delimiter="}}";matched=true}}else if(comment.indexOf("<?")===0){delimiter="?>";matched=true}else if(comment.indexOf("<%")===0){delimiter="%>";matched=true}input_char=this.input.charAt(this.pos);this.pos++}return comment};function tokenMatcher(delimiter){var token="";var add=function(str){var newToken=token+str.toLowerCase();token=newToken.length<=delimiter.length?newToken:newToken.substr(newToken.length-delimiter.length,delimiter.length)};var doesNotMatch=function(){return token.indexOf(delimiter)===-1};return{add:add,doesNotMatch:doesNotMatch}}this.get_unformatted=function(delimiter,orig_tag){if(orig_tag&&orig_tag.toLowerCase().indexOf(delimiter)!==-1)return"";var input_char="";var content="";var space=true;var delimiterMatcher=tokenMatcher(delimiter);do{if(this.pos>=this.input.length)return content;input_char=this.input.charAt(this.pos);this.pos++;if(this.Utils.in_array(input_char,this.Utils.whitespace)){if(!space){this.line_char_count--;continue}if(input_char==="\n"||input_char==="\r"){content+="\n";this.line_char_count=0;continue}}content+=input_char;delimiterMatcher.add(input_char);this.line_char_count++;space=true;if(indent_handlebars&&input_char==="{"&&content.length&&content.charAt(content.length-2)==="{")content+=this.get_unformatted("}}")}while(delimiterMatcher.doesNotMatch());return content};this.get_token=function(){var token;if(this.last_token==="TK_TAG_SCRIPT"||this.last_token==="TK_TAG_STYLE"){var type=this.last_token.substr(7);token=this.get_contents_to(type);if(typeof token!=="string")return token;return[token,"TK_"+type]}if(this.current_mode==="CONTENT"){token=this.get_content();if(typeof token!=="string")return token;else return[token,"TK_CONTENT"]}if(this.current_mode==="TAG"){token=this.get_tag();if(typeof token!=="string")return token;else{var tag_name_type="TK_TAG_"+this.tag_type;return[token,tag_name_type]}}};this.get_full_indent=function(level){level=this.indent_level+level||0;if(level<1)return"";return Array(level+1).join(this.indent_string)};this.is_unformatted=function(tag_check,unformatted){if(!this.Utils.in_array(tag_check,unformatted))return false;if(tag_check.toLowerCase()!=="a"||!this.Utils.in_array("a",unformatted))return true;var next_tag=this.get_tag(true);var tag=(next_tag||"").match(/^\s*<\s*\/?([a-z]*)\s*[^>]*>\s*$/);if(!tag||this.Utils.in_array(tag[1],unformatted))return true;else return false};this.printer=function(js_source,indent_character,indent_size,wrap_line_length,brace_style){this.input=js_source||"";this.input=this.input.replace(/\r\n|[\r\u2028\u2029]/g,"\n");this.output=[];this.indent_character=indent_character;this.indent_string="";this.indent_size=indent_size;this.brace_style=brace_style;this.indent_level=0;this.wrap_line_length=wrap_line_length;this.line_char_count=0;for(var i=0;i<this.indent_size;i++)this.indent_string+=this.indent_character;this.print_newline=function(force,arr){this.line_char_count=0;if(!arr||!arr.length)return;if(force||arr[arr.length-1]!=="\n"){if(arr[arr.length-1]!=="\n")arr[arr.length-1]=rtrim(arr[arr.length-1]);arr.push("\n")}};this.print_indentation=function(arr){for(var i=0;i<this.indent_level;i++){arr.push(this.indent_string);this.line_char_count+=this.indent_string.length}};this.print_token=function(text){if(this.is_whitespace(text)&&!this.output.length)return;if(text||text!=="")if(this.output.length&&this.output[this.output.length-1]==="\n"){this.print_indentation(this.output);text=ltrim(text)}this.print_token_raw(text)};this.print_token_raw=function(text){if(this.newlines>0)text=rtrim(text);if(text&&text!=="")if(text.length>1&&text.charAt(text.length-1)==="\n"){this.output.push(text.slice(0,-1));this.print_newline(false,this.output)}else this.output.push(text);for(var n=0;n<this.newlines;n++)this.print_newline(n>0,this.output);this.newlines=0};this.indent=function(){this.indent_level++};this.unindent=function(){if(this.indent_level>0)this.indent_level--}};return this}multi_parser=new Parser;multi_parser.printer(html_source,indent_character,indent_size,wrap_line_length,brace_style);while(true){var t=multi_parser.get_token();multi_parser.token_text=t[0];multi_parser.token_type=t[1];if(multi_parser.token_type==="TK_EOF")break;switch(multi_parser.token_type){case"TK_TAG_START":multi_parser.print_newline(false,multi_parser.output);multi_parser.print_token(multi_parser.token_text);if(multi_parser.indent_content){if((multi_parser.indent_body_inner_html||!multi_parser.token_text.match(/<body(?:.*)>/))&&(multi_parser.indent_head_inner_html||!multi_parser.token_text.match(/<head(?:.*)>/)))multi_parser.indent();multi_parser.indent_content=false}multi_parser.current_mode="CONTENT";break;case"TK_TAG_STYLE":case"TK_TAG_SCRIPT":multi_parser.print_newline(false,multi_parser.output);multi_parser.print_token(multi_parser.token_text);multi_parser.current_mode="CONTENT";break;case"TK_TAG_END":if(multi_parser.last_token==="TK_CONTENT"&&multi_parser.last_text===""){var tag_name=(multi_parser.token_text.match(/\w+/)||[])[0];var tag_extracted_from_last_output=null;if(multi_parser.output.length)tag_extracted_from_last_output=multi_parser.output[multi_parser.output.length-1].match(/(?:<|{{#)\s*(\w+)/);if(tag_extracted_from_last_output===null||tag_extracted_from_last_output[1]!==tag_name&&!multi_parser.Utils.in_array(tag_extracted_from_last_output[1],unformatted))multi_parser.print_newline(false,multi_parser.output)}multi_parser.print_token(multi_parser.token_text);multi_parser.current_mode="CONTENT";break;case"TK_TAG_SINGLE":var tag_check=multi_parser.token_text.match(/^\s*<([a-z-]+)/i);if(!tag_check||!multi_parser.Utils.in_array(tag_check[1],unformatted))multi_parser.print_newline(false,multi_parser.output);multi_parser.print_token(multi_parser.token_text);multi_parser.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_ELSE":var foundIfOnCurrentLine=false;for(var lastCheckedOutput=multi_parser.output.length-1;lastCheckedOutput>=0;lastCheckedOutput--)if(multi_parser.output[lastCheckedOutput]==="\n")break;else if(multi_parser.output[lastCheckedOutput].match(/{{#if/)){foundIfOnCurrentLine=true;break}if(!foundIfOnCurrentLine)multi_parser.print_newline(false,multi_parser.output);multi_parser.print_token(multi_parser.token_text);if(multi_parser.indent_content){multi_parser.indent();multi_parser.indent_content=false}multi_parser.current_mode="CONTENT";break;case"TK_TAG_HANDLEBARS_COMMENT":multi_parser.print_token(multi_parser.token_text);multi_parser.current_mode="TAG";break;case"TK_CONTENT":multi_parser.print_token(multi_parser.token_text);multi_parser.current_mode="TAG";break;case"TK_STYLE":case"TK_SCRIPT":if(multi_parser.token_text!==""){multi_parser.print_newline(false,multi_parser.output);var text=multi_parser.token_text,_beautifier,script_indent_level=1;if(multi_parser.token_type==="TK_SCRIPT")_beautifier=typeof js_beautify==="function"&&js_beautify;else if(multi_parser.token_type==="TK_STYLE")_beautifier=typeof css_beautify==="function"&&css_beautify;if(options.indent_scripts==="keep")script_indent_level=0;else if(options.indent_scripts==="separate")script_indent_level=-multi_parser.indent_level;var indentation=multi_parser.get_full_indent(script_indent_level);if(_beautifier){var Child_options=function(){this.eol="\n"};Child_options.prototype=options;var child_options=new Child_options;text=_beautifier(text.replace(/^\s*/,indentation),child_options)}else{var white=text.match(/^\s*/)[0];var _level=white.match(/[^\n\r]*$/)[0].split(multi_parser.indent_string).length-1;var reindent=multi_parser.get_full_indent(script_indent_level-_level);text=text.replace(/^\s*/,indentation).replace(/\r\n|\r|\n/g,"\n"+reindent).replace(/\s+$/,"")}if(text){multi_parser.print_token_raw(text);multi_parser.print_newline(true,multi_parser.output)}}multi_parser.current_mode="TAG";break;default:if(multi_parser.token_text!=="")multi_parser.print_token(multi_parser.token_text);break}multi_parser.last_token=multi_parser.token_type;multi_parser.last_text=multi_parser.token_text}var sweet_code=multi_parser.output.join("").replace(/[\r\n\t ]+$/,"");if(end_with_newline)sweet_code+="\n";if(eol!=="\n")sweet_code=sweet_code.replace(/[\n]/g,eol);return sweet_code}if(typeof define==="function"&&define.amd)define(["require","./beautify","./beautify-css"],function(requireamd){var js_beautify=requireamd("./beautify");var css_beautify=requireamd("./beautify-css");return{html_beautify:function(html_source,options){return style_html(html_source,options,js_beautify.js_beautify,css_beautify.css_beautify)}}});else if(typeof exports!=="undefined"){var js_beautify=require("./beautify.js");var css_beautify=require("./beautify-css.js");exports.html_beautify=function(html_source,options){return style_html(html_source,options,js_beautify.js_beautify,css_beautify.css_beautify)}}else if(typeof window!=="undefined")window.html_beautify=function(html_source,options){return style_html(html_source,options,window.js_beautify,window.css_beautify)};else if(typeof global!=="undefined")global.html_beautify=function(html_source,options){return style_html(html_source,options,global.js_beautify,global.css_beautify)}})()}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./beautify-css.js":1,"./beautify.js":3}],3:[function(require,module,exports){(function(global){if(!Object.values)Object.values=function(o){if(o!==Object(o))throw new TypeError("Object.values called on a non-object");var k=[],p;for(p in o)if(Object.prototype.hasOwnProperty.call(o,p))k.push(o[p]);return k};(function(){function mergeOpts(allOptions,targetType){var finalOpts={};var name;for(name in allOptions)if(name!==targetType)finalOpts[name]=allOptions[name];if(targetType in allOptions)for(name in allOptions[targetType])finalOpts[name]=allOptions[targetType][name];return finalOpts}function js_beautify(js_source_text,options){var acorn={};(function(exports){var nonASCIIwhitespace=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/;var nonASCIIidentifierStartChars="ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԧԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠࢢ-ࢬऄ-हऽॐक़-ॡॱ-ॷॹ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛰᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤜᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚗꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞓꞠ-Ɦꟸ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꪀ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ";var nonASCIIidentifierChars="̀-ͯ҃-֑҇-ׇֽֿׁׂׅׄؐ-ؚؠ-ىٲ-ۓۧ-ۨۻ-ۼܰ-݊ࠀ-ࠔࠛ-ࠣࠥ-ࠧࠩ-࠭ࡀ-ࡗࣤ-ࣾऀ-ःऺ-़ा-ॏ॑-ॗॢ-ॣ०-९ঁ-ঃ়া-ৄেৈৗয়-ৠਁ-ਃ਼ਾ-ੂੇੈੋ-੍ੑ੦-ੱੵઁ-ઃ઼ા-ૅે-ૉો-્ૢ-ૣ૦-૯ଁ-ଃ଼ା-ୄେୈୋ-୍ୖୗୟ-ୠ୦-୯ஂா-ூெ-ைொ-்ௗ௦-௯ఁ-ఃె-ైొ-్ౕౖౢ-ౣ౦-౯ಂಃ಼ಾ-ೄೆ-ೈೊ-್ೕೖೢ-ೣ೦-೯ംഃെ-ൈൗൢ-ൣ൦-൯ංඃ්ා-ුූෘ-ෟෲෳิ-ฺเ-ๅ๐-๙ິ-ູ່-ໍ໐-໙༘༙༠-༩༹༵༷ཁ-ཇཱ-྄྆-྇ྍ-ྗྙ-ྼ࿆က-ဩ၀-၉ၧ-ၭၱ-ၴႂ-ႍႏ-ႝ፝-፟ᜎ-ᜐᜠ-ᜰᝀ-ᝐᝲᝳក-ឲ៝០-៩᠋-᠍᠐-᠙ᤠ-ᤫᤰ-᤻ᥑ-ᥭᦰ-ᧀᧈ-ᧉ᧐-᧙ᨀ-ᨕᨠ-ᩓ᩠-᩿᩼-᪉᪐-᪙ᭆ-ᭋ᭐-᭙᭫-᭳᮰-᮹᯦-᯳ᰀ-ᰢ᱀-᱉ᱛ-ᱽ᳐-᳒ᴀ-ᶾḁ-ἕ‌‍‿⁀⁔⃐-⃥⃜⃡-⃰ⶁ-ⶖⷠ-ⷿ〡-〨゙゚Ꙁ-ꙭꙴ-꙽ꚟ꛰-꛱ꟸ-ꠀ꠆ꠋꠣ-ꠧꢀ-ꢁꢴ-꣄꣐-꣙ꣳ-ꣷ꤀-꤉ꤦ-꤭ꤰ-ꥅꦀ-ꦃ꦳-꧀ꨀ-ꨧꩀ-ꩁꩌ-ꩍ꩐-꩙ꩻꫠ-ꫩꫲ-ꫳꯀ-ꯡ꯬꯭꯰-꯹ﬠ-ﬨ︀-️︠-︦︳︴﹍-﹏０-９＿";var nonASCIIidentifierStart=new RegExp("["+nonASCIIidentifierStartChars+"]");var nonASCIIidentifier=new RegExp("["+nonASCIIidentifierStartChars+nonASCIIidentifierChars+"]");exports.newline=/[\n\r\u2028\u2029]/;exports.lineBreak=new RegExp("\r\n|"+exports.newline.source);exports.allLineBreaks=new RegExp(exports.lineBreak.source,"g");exports.isIdentifierStart=function(code){if(code<65)return code===36||code===64;if(code<91)return true;if(code<97)return code===95;if(code<123)return true;return code>=170&&nonASCIIidentifierStart.test(String.fromCharCode(code))};exports.isIdentifierChar=function(code){if(code<48)return code===36;if(code<58)return true;if(code<65)return false;if(code<91)return true;if(code<97)return code===95;if(code<123)return true;return code>=170&&nonASCIIidentifier.test(String.fromCharCode(code))}})(acorn);function in_array(what,arr){for(var i=0;i<arr.length;i+=1)if(arr[i]===what)return true;return false}function trim(s){return s.replace(/^\s+|\s+$/g,"")}function ltrim(s){return s.replace(/^\s+/g,"")}function sanitizeOperatorPosition(opPosition){opPosition=opPosition||OPERATOR_POSITION.before_newline;var validPositionValues=Object.values(OPERATOR_POSITION);if(!in_array(opPosition,validPositionValues))throw new Error("Invalid Option Value: The option 'operator_position' must be one of the following values\n"+validPositionValues+"\nYou passed in: '"+opPosition+"'");return opPosition}var OPERATOR_POSITION={before_newline:"before-newline",after_newline:"after-newline",preserve_newline:"preserve-newline"};var OPERATOR_POSITION_BEFORE_OR_PRESERVE=[OPERATOR_POSITION.before_newline,OPERATOR_POSITION.preserve_newline];var MODE={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"};function Beautifier(js_source_text,options){var output;var tokens=[],token_pos;var Tokenizer;var current_token;var last_type,last_last_text,indent_string;var flags,previous_flags,flag_store;var prefix;var handlers,opt;var baseIndentString="";handlers={TK_START_EXPR:handle_start_expr,TK_END_EXPR:handle_end_expr,TK_START_BLOCK:handle_start_block,TK_END_BLOCK:handle_end_block,TK_WORD:handle_word,TK_RESERVED:handle_word,TK_SEMICOLON:handle_semicolon,TK_STRING:handle_string,TK_EQUALS:handle_equals,TK_OPERATOR:handle_operator,TK_COMMA:handle_comma,TK_BLOCK_COMMENT:handle_block_comment,TK_COMMENT:handle_comment,TK_DOT:handle_dot,TK_UNKNOWN:handle_unknown,TK_EOF:handle_eof};function create_flags(flags_base,mode){var next_indent_level=0;if(flags_base){next_indent_level=flags_base.indentation_level;if(!output.just_added_newline()&&flags_base.line_indent_level>next_indent_level)next_indent_level=flags_base.line_indent_level}var next_flags={mode:mode,parent:flags_base,last_text:flags_base?flags_base.last_text:"",last_word:flags_base?flags_base.last_word:"",declaration_statement:false,declaration_assignment:false,multiline_frame:false,inline_frame:false,if_block:false,else_block:false,do_block:false,do_while:false,import_block:false,in_case_statement:false,in_case:false,case_body:false,indentation_level:next_indent_level,line_indent_level:flags_base?flags_base.line_indent_level:next_indent_level,start_line_index:output.get_line_number(),ternary_depth:0};return next_flags}options=options?options:{};options=mergeOpts(options,"js");opt={};if(options.brace_style==="expand-strict")options.brace_style="expand";else if(options.brace_style==="collapse-preserve-inline")options.brace_style="collapse,preserve-inline";else if(options.braces_on_own_line!==undefined)options.brace_style=options.braces_on_own_line?"expand":"collapse";else if(!options.brace_style)options.brace_style="collapse";var brace_style_split=options.brace_style.split(/[^a-zA-Z0-9_\-]+/);opt.brace_style=brace_style_split[0];opt.brace_preserve_inline=brace_style_split[1]?brace_style_split[1]:false;opt.indent_size=options.indent_size?parseInt(options.indent_size,10):4;opt.indent_char=options.indent_char?options.indent_char:" ";opt.eol=options.eol?options.eol:"auto";opt.preserve_newlines=options.preserve_newlines===undefined?true:options.preserve_newlines;opt.break_chained_methods=options.break_chained_methods===undefined?false:options.break_chained_methods;opt.max_preserve_newlines=options.max_preserve_newlines===undefined?0:parseInt(options.max_preserve_newlines,10);opt.space_in_paren=options.space_in_paren===undefined?false:options.space_in_paren;opt.space_in_empty_paren=options.space_in_empty_paren===undefined?false:options.space_in_empty_paren;opt.jslint_happy=options.jslint_happy===undefined?false:options.jslint_happy;opt.space_after_anon_function=options.space_after_anon_function===undefined?false:options.space_after_anon_function;opt.keep_array_indentation=options.keep_array_indentation===undefined?false:options.keep_array_indentation;opt.space_before_conditional=options.space_before_conditional===undefined?true:options.space_before_conditional;opt.unescape_strings=options.unescape_strings===undefined?false:options.unescape_strings;opt.wrap_line_length=options.wrap_line_length===undefined?0:parseInt(options.wrap_line_length,10);opt.e4x=options.e4x===undefined?false:options.e4x;opt.end_with_newline=options.end_with_newline===undefined?false:options.end_with_newline;opt.comma_first=options.comma_first===undefined?false:options.comma_first;opt.operator_position=sanitizeOperatorPosition(options.operator_position);opt.test_output_raw=options.test_output_raw===undefined?false:options.test_output_raw;if(opt.jslint_happy)opt.space_after_anon_function=true;if(options.indent_with_tabs){opt.indent_char="\t";opt.indent_size=1}if(opt.eol==="auto"){opt.eol="\n";if(js_source_text&&acorn.lineBreak.test(js_source_text||""))opt.eol=js_source_text.match(acorn.lineBreak)[0]}opt.eol=opt.eol.replace(/\\r/,"\r").replace(/\\n/,"\n");indent_string="";while(opt.indent_size>0){indent_string+=opt.indent_char;opt.indent_size-=1}var preindent_index=0;if(js_source_text&&js_source_text.length){while(js_source_text.charAt(preindent_index)===" "||js_source_text.charAt(preindent_index)==="\t"){baseIndentString+=js_source_text.charAt(preindent_index);preindent_index+=1}js_source_text=js_source_text.substring(preindent_index)}last_type="TK_START_BLOCK";last_last_text="";output=new Output(indent_string,baseIndentString);output.raw=opt.test_output_raw;flag_store=[];set_mode(MODE.BlockStatement);this.beautify=function(){var sweet_code;Tokenizer=new tokenizer(js_source_text,opt,indent_string);tokens=Tokenizer.tokenize();token_pos=0;current_token=get_token();while(current_token){handlers[current_token.type]();last_last_text=flags.last_text;last_type=current_token.type;flags.last_text=current_token.text;token_pos+=1;current_token=get_token()}sweet_code=output.get_code();if(opt.end_with_newline)sweet_code+="\n";if(opt.eol!=="\n")sweet_code=sweet_code.replace(/[\n]/g,opt.eol);return sweet_code};function handle_whitespace_and_comments(local_token,preserve_statement_flags){var newlines=local_token.newlines;var keep_whitespace=opt.keep_array_indentation&&is_array(flags.mode);var temp_token=current_token;for(var h=0;h<local_token.comments_before.length;h++){current_token=local_token.comments_before[h];handle_whitespace_and_comments(current_token,preserve_statement_flags);handlers[current_token.type](preserve_statement_flags)}current_token=temp_token;if(keep_whitespace)for(var i=0;i<newlines;i+=1)print_newline(i>0,preserve_statement_flags);else{if(opt.max_preserve_newlines&&newlines>opt.max_preserve_newlines)newlines=opt.max_preserve_newlines;if(opt.preserve_newlines)if(local_token.newlines>1){print_newline(false,preserve_statement_flags);for(var j=1;j<newlines;j+=1)print_newline(true,preserve_statement_flags)}}}function split_linebreaks(s){s=s.replace(acorn.allLineBreaks,"\n");var out=[],idx=s.indexOf("\n");while(idx!==-1){out.push(s.substring(0,idx));s=s.substring(idx+1);idx=s.indexOf("\n")}if(s.length)out.push(s);return out}var newline_restricted_tokens=["break","continue","return","throw"];function allow_wrap_or_preserved_newline(force_linewrap){force_linewrap=force_linewrap===undefined?false:force_linewrap;if(output.just_added_newline())return;var shouldPreserveOrForce=opt.preserve_newlines&&current_token.wanted_newline||force_linewrap;var operatorLogicApplies=in_array(flags.last_text,Tokenizer.positionable_operators)||in_array(current_token.text,Tokenizer.positionable_operators);if(operatorLogicApplies){var shouldPrintOperatorNewline=in_array(flags.last_text,Tokenizer.positionable_operators)&&in_array(opt.operator_position,OPERATOR_POSITION_BEFORE_OR_PRESERVE)||in_array(current_token.text,Tokenizer.positionable_operators);shouldPreserveOrForce=shouldPreserveOrForce&&shouldPrintOperatorNewline}if(shouldPreserveOrForce)print_newline(false,true);else if(opt.wrap_line_length){if(last_type==="TK_RESERVED"&&in_array(flags.last_text,newline_restricted_tokens))return;var proposed_line_length=output.current_line.get_character_count()+current_token.text.length+(output.space_before_token?1:0);if(proposed_line_length>=opt.wrap_line_length)print_newline(false,true)}}function print_newline(force_newline,preserve_statement_flags){if(!preserve_statement_flags)if(flags.last_text!==";"&&flags.last_text!==","&&flags.last_text!=="="&&last_type!=="TK_OPERATOR"){var next_token=get_token(1);while(flags.mode===MODE.Statement&&!(flags.if_block&&next_token&&next_token.type==="TK_RESERVED"&&next_token.text==="else")&&!flags.do_block)restore_mode()}if(output.add_new_line(force_newline))flags.multiline_frame=true}function print_token_line_indentation(){if(output.just_added_newline())if(opt.keep_array_indentation&&is_array(flags.mode)&&current_token.wanted_newline){output.current_line.push(current_token.whitespace_before);output.space_before_token=false}else if(output.set_indent(flags.indentation_level))flags.line_indent_level=flags.indentation_level}function print_token(printable_token){if(output.raw){output.add_raw_token(current_token);return}if(opt.comma_first&&last_type==="TK_COMMA"&&output.just_added_newline())if(output.previous_line.last()===","){var popped=output.previous_line.pop();if(output.previous_line.is_empty()){output.previous_line.push(popped);output.trim(true);output.current_line.pop();output.trim()}print_token_line_indentation();output.add_token(",");output.space_before_token=true}printable_token=printable_token||current_token.text;print_token_line_indentation();output.add_token(printable_token)}function indent(){flags.indentation_level+=1}function deindent(){if(flags.indentation_level>0&&(!flags.parent||flags.indentation_level>flags.parent.indentation_level))flags.indentation_level-=1}function set_mode(mode){if(flags){flag_store.push(flags);previous_flags=flags}else previous_flags=create_flags(null,mode);flags=create_flags(previous_flags,mode)}function is_array(mode){return mode===MODE.ArrayLiteral}function is_expression(mode){return in_array(mode,[MODE.Expression,MODE.ForInitializer,MODE.Conditional])}function restore_mode(){if(flag_store.length>0){previous_flags=flags;flags=flag_store.pop();if(previous_flags.mode===MODE.Statement)output.remove_redundant_indentation(previous_flags)}}function start_of_object_property(){return flags.parent.mode===MODE.ObjectLiteral&&flags.mode===MODE.Statement&&(flags.last_text===":"&&flags.ternary_depth===0||last_type==="TK_RESERVED"&&in_array(flags.last_text,["get","set"]))}function start_of_statement(){if(last_type==="TK_RESERVED"&&in_array(flags.last_text,["var","let","const"])&&current_token.type==="TK_WORD"||last_type==="TK_RESERVED"&&flags.last_text==="do"||last_type==="TK_RESERVED"&&in_array(flags.last_text,["return","throw"])&&!current_token.wanted_newline||last_type==="TK_RESERVED"&&flags.last_text==="else"&&!(current_token.type==="TK_RESERVED"&&current_token.text==="if"&&!current_token.comments_before.length)||last_type==="TK_END_EXPR"&&(previous_flags.mode===MODE.ForInitializer||previous_flags.mode===MODE.Conditional)||last_type==="TK_WORD"&&flags.mode===MODE.BlockStatement&&!flags.in_case&&!(current_token.text==="--"||current_token.text==="++")&&last_last_text!=="function"&&current_token.type!=="TK_WORD"&&current_token.type!=="TK_RESERVED"||flags.mode===MODE.ObjectLiteral&&(flags.last_text===":"&&flags.ternary_depth===0||last_type==="TK_RESERVED"&&in_array(flags.last_text,["get","set"]))){set_mode(MODE.Statement);indent();handle_whitespace_and_comments(current_token,true);if(!start_of_object_property())allow_wrap_or_preserved_newline(current_token.type==="TK_RESERVED"&&in_array(current_token.text,["do","for","if","while"]));return true}return false}function all_lines_start_with(lines,c){for(var i=0;i<lines.length;i++){var line=trim(lines[i]);if(line.charAt(0)!==c)return false}return true}function each_line_matches_indent(lines,indent){var i=0,len=lines.length,line;for(;i<len;i++){line=lines[i];if(line&&line.indexOf(indent)!==0)return false}return true}function is_special_word(word){return in_array(word,["case","return","do","if","throw","else"])}function get_token(offset){var index=token_pos+(offset||0);return index<0||index>=tokens.length?null:tokens[index]}function handle_start_expr(){if(!start_of_statement())handle_whitespace_and_comments(current_token);var next_mode=MODE.Expression;if(current_token.text==="["){if(last_type==="TK_WORD"||flags.last_text===")"){if(last_type==="TK_RESERVED"&&in_array(flags.last_text,Tokenizer.line_starters))output.space_before_token=true;set_mode(next_mode);print_token();indent();if(opt.space_in_paren)output.space_before_token=true;return}next_mode=MODE.ArrayLiteral;if(is_array(flags.mode))if(flags.last_text==="["||flags.last_text===","&&(last_last_text==="]"||last_last_text==="}"))if(!opt.keep_array_indentation)print_newline()}else if(last_type==="TK_RESERVED"&&flags.last_text==="for")next_mode=MODE.ForInitializer;else if(last_type==="TK_RESERVED"&&in_array(flags.last_text,["if","while"]))next_mode=MODE.Conditional;else;if(flags.last_text===";"||last_type==="TK_START_BLOCK")print_newline();else if(last_type==="TK_END_EXPR"||last_type==="TK_START_EXPR"||last_type==="TK_END_BLOCK"||flags.last_text===".")allow_wrap_or_preserved_newline(current_token.wanted_newline);else if(!(last_type==="TK_RESERVED"&&current_token.text==="(")&&last_type!=="TK_WORD"&&last_type!=="TK_OPERATOR")output.space_before_token=true;else if(last_type==="TK_RESERVED"&&(flags.last_word==="function"||flags.last_word==="typeof")||flags.last_text==="*"&&(in_array(last_last_text,["function","yield"])||flags.mode===MODE.ObjectLiteral&&in_array(last_last_text,["{",","]))){if(opt.space_after_anon_function)output.space_before_token=true}else if(last_type==="TK_RESERVED"&&(in_array(flags.last_text,Tokenizer.line_starters)||flags.last_text==="catch"))if(opt.space_before_conditional)output.space_before_token=true;if(current_token.text==="("&&last_type==="TK_RESERVED"&&flags.last_word==="await")output.space_before_token=true;if(current_token.text==="(")if(last_type==="TK_EQUALS"||last_type==="TK_OPERATOR")if(!start_of_object_property())allow_wrap_or_preserved_newline();if(current_token.text==="("&&last_type!=="TK_WORD"&&last_type!=="TK_RESERVED")allow_wrap_or_preserved_newline();set_mode(next_mode);print_token();if(opt.space_in_paren)output.space_before_token=true;indent()}function handle_end_expr(){while(flags.mode===MODE.Statement)restore_mode();handle_whitespace_and_comments(current_token);if(flags.multiline_frame)allow_wrap_or_preserved_newline(current_token.text==="]"&&is_array(flags.mode)&&!opt.keep_array_indentation);if(opt.space_in_paren)if(last_type==="TK_START_EXPR"&&!opt.space_in_empty_paren){output.trim();output.space_before_token=false}else output.space_before_token=true;if(current_token.text==="]"&&opt.keep_array_indentation){print_token();restore_mode()}else{restore_mode();print_token()}output.remove_redundant_indentation(previous_flags);if(flags.do_while&&previous_flags.mode===MODE.Conditional){previous_flags.mode=MODE.Expression;flags.do_block=false;flags.do_while=false}}function handle_start_block(){handle_whitespace_and_comments(current_token);var next_token=get_token(1);var second_token=get_token(2);if(second_token&&(in_array(second_token.text,[":",","])&&in_array(next_token.type,["TK_STRING","TK_WORD","TK_RESERVED"])||in_array(next_token.text,["get","set","..."])&&in_array(second_token.type,["TK_WORD","TK_RESERVED"])))if(!in_array(last_last_text,["class","interface"]))set_mode(MODE.ObjectLiteral);else set_mode(MODE.BlockStatement);else if(last_type==="TK_OPERATOR"&&flags.last_text==="=>")set_mode(MODE.BlockStatement);else if(in_array(last_type,["TK_EQUALS","TK_START_EXPR","TK_COMMA","TK_OPERATOR"])||last_type==="TK_RESERVED"&&in_array(flags.last_text,["return","throw","import","default"]))set_mode(MODE.ObjectLiteral);else set_mode(MODE.BlockStatement);var empty_braces=!next_token.comments_before.length&&next_token.text==="}";var empty_anonymous_function=empty_braces&&flags.last_word==="function"&&last_type==="TK_END_EXPR";if(opt.brace_preserve_inline){var index=0;var check_token=null;flags.inline_frame=true;do{index+=1;check_token=get_token(index);if(check_token.wanted_newline){flags.inline_frame=false;break}}while(check_token.type!=="TK_EOF"&&!(check_token.type==="TK_END_BLOCK"&&check_token.opened===current_token))}if((opt.brace_style==="expand"||opt.brace_style==="none"&&current_token.wanted_newline)&&!flags.inline_frame)if(last_type!=="TK_OPERATOR"&&(empty_anonymous_function||last_type==="TK_EQUALS"||last_type==="TK_RESERVED"&&is_special_word(flags.last_text)&&flags.last_text!=="else"))output.space_before_token=true;else print_newline(false,true);else{if(is_array(previous_flags.mode)&&(last_type==="TK_START_EXPR"||last_type==="TK_COMMA")){if(last_type==="TK_COMMA"||opt.space_in_paren)output.space_before_token=true;if(last_type==="TK_COMMA"||last_type==="TK_START_EXPR"&&flags.inline_frame){allow_wrap_or_preserved_newline();previous_flags.multiline_frame=previous_flags.multiline_frame||flags.multiline_frame;flags.multiline_frame=false}}if(last_type!=="TK_OPERATOR"&&last_type!=="TK_START_EXPR")if(last_type==="TK_START_BLOCK"&&!flags.inline_frame)print_newline();else output.space_before_token=true}print_token();indent()}function handle_end_block(){handle_whitespace_and_comments(current_token);while(flags.mode===MODE.Statement)restore_mode();var empty_braces=last_type==="TK_START_BLOCK";if(flags.inline_frame&&!empty_braces)output.space_before_token=true;else if(opt.brace_style==="expand"){if(!empty_braces)print_newline()}else if(!empty_braces)if(is_array(flags.mode)&&opt.keep_array_indentation){opt.keep_array_indentation=false;print_newline();opt.keep_array_indentation=true}else print_newline();restore_mode();print_token()}function handle_word(){if(current_token.type==="TK_RESERVED")if(in_array(current_token.text,["set","get"])&&flags.mode!==MODE.ObjectLiteral)current_token.type="TK_WORD";else if(in_array(current_token.text,["as","from"])&&!flags.import_block)current_token.type="TK_WORD";else if(flags.mode===MODE.ObjectLiteral){var next_token=get_token(1);if(next_token.text===":")current_token.type="TK_WORD"}if(start_of_statement()){if(last_type==="TK_RESERVED"&&in_array(flags.last_text,["var","let","const"])&&current_token.type==="TK_WORD")flags.declaration_statement=true}else if(current_token.wanted_newline&&!is_expression(flags.mode)&&(last_type!=="TK_OPERATOR"||(flags.last_text==="--"||flags.last_text==="++"))&&last_type!=="TK_EQUALS"&&(opt.preserve_newlines||!(last_type==="TK_RESERVED"&&in_array(flags.last_text,["var","let","const","set","get"])))){handle_whitespace_and_comments(current_token);print_newline()}else handle_whitespace_and_comments(current_token);if(flags.do_block&&!flags.do_while)if(current_token.type==="TK_RESERVED"&&current_token.text==="while"){output.space_before_token=true;print_token();output.space_before_token=true;flags.do_while=true;return}else{print_newline();flags.do_block=false}if(flags.if_block)if(!flags.else_block&&(current_token.type==="TK_RESERVED"&&current_token.text==="else"))flags.else_block=true;else{while(flags.mode===MODE.Statement)restore_mode();flags.if_block=false;flags.else_block=false}if(current_token.type==="TK_RESERVED"&&(current_token.text==="case"||current_token.text==="default"&&flags.in_case_statement)){print_newline();if(flags.case_body||opt.jslint_happy){deindent();flags.case_body=false}print_token();flags.in_case=true;flags.in_case_statement=true;return}if(last_type==="TK_COMMA"||last_type==="TK_START_EXPR"||last_type==="TK_EQUALS"||last_type==="TK_OPERATOR")if(!start_of_object_property())allow_wrap_or_preserved_newline();if(current_token.type==="TK_RESERVED"&&current_token.text==="function"){if(in_array(flags.last_text,["}",";"])||output.just_added_newline()&&!(in_array(flags.last_text,["(","[","{",":","=",","])||last_type==="TK_OPERATOR"))if(!output.just_added_blankline()&&!current_token.comments_before.length){print_newline();print_newline(true)}if(last_type==="TK_RESERVED"||last_type==="TK_WORD")if(last_type==="TK_RESERVED"&&in_array(flags.last_text,["get","set","new","return","export","async"]))output.space_before_token=true;else if(last_type==="TK_RESERVED"&&flags.last_text==="default"&&last_last_text==="export")output.space_before_token=true;else print_newline();else if(last_type==="TK_OPERATOR"||flags.last_text==="=")output.space_before_token=true;else if(!flags.multiline_frame&&(is_expression(flags.mode)||is_array(flags.mode)));else print_newline();print_token();flags.last_word=current_token.text;return}prefix="NONE";if(last_type==="TK_END_BLOCK")if(previous_flags.inline_frame)prefix="SPACE";else if(!(current_token.type==="TK_RESERVED"&&in_array(current_token.text,["else","catch","finally","from"])))prefix="NEWLINE";else if(opt.brace_style==="expand"||opt.brace_style==="end-expand"||opt.brace_style==="none"&&current_token.wanted_newline)prefix="NEWLINE";else{prefix="SPACE";output.space_before_token=true}else if(last_type==="TK_SEMICOLON"&&flags.mode===MODE.BlockStatement)prefix="NEWLINE";else if(last_type==="TK_SEMICOLON"&&is_expression(flags.mode))prefix="SPACE";else if(last_type==="TK_STRING")prefix="NEWLINE";else if(last_type==="TK_RESERVED"||last_type==="TK_WORD"||flags.last_text==="*"&&(in_array(last_last_text,["function","yield"])||flags.mode===MODE.ObjectLiteral&&in_array(last_last_text,["{",","])))prefix="SPACE";else if(last_type==="TK_START_BLOCK")if(flags.inline_frame)prefix="SPACE";else prefix="NEWLINE";else if(last_type==="TK_END_EXPR"){output.space_before_token=true;prefix="NEWLINE"}if(current_token.type==="TK_RESERVED"&&in_array(current_token.text,Tokenizer.line_starters)&&flags.last_text!==")")if(flags.inline_frame||flags.last_text==="else"||flags.last_text==="export")prefix="SPACE";else prefix="NEWLINE";if(current_token.type==="TK_RESERVED"&&in_array(current_token.text,["else","catch","finally"]))if((!(last_type==="TK_END_BLOCK"&&previous_flags.mode===MODE.BlockStatement)||opt.brace_style==="expand"||opt.brace_style==="end-expand"||opt.brace_style==="none"&&current_token.wanted_newline)&&!flags.inline_frame)print_newline();else{output.trim(true);var line=output.current_line;if(line.last()!=="}")print_newline();output.space_before_token=true}else if(prefix==="NEWLINE")if(last_type==="TK_RESERVED"&&is_special_word(flags.last_text))output.space_before_token=true;else if(last_type!=="TK_END_EXPR"){if((last_type!=="TK_START_EXPR"||!(current_token.type==="TK_RESERVED"&&in_array(current_token.text,["var","let","const"])))&&flags.last_text!==":")if(current_token.type==="TK_RESERVED"&&current_token.text==="if"&&flags.last_text==="else")output.space_before_token=true;else print_newline()}else{if(current_token.type==="TK_RESERVED"&&in_array(current_token.text,Tokenizer.line_starters)&&flags.last_text!==")")print_newline()}else if(flags.multiline_frame&&is_array(flags.mode)&&flags.last_text===","&&last_last_text==="}")print_newline();else if(prefix==="SPACE")output.space_before_token=true;print_token();flags.last_word=current_token.text;if(current_token.type==="TK_RESERVED")if(current_token.text==="do")flags.do_block=true;else if(current_token.text==="if")flags.if_block=true;else if(current_token.text==="import")flags.import_block=true;else if(flags.import_block&&current_token.type==="TK_RESERVED"&&current_token.text==="from")flags.import_block=false}function handle_semicolon(){if(start_of_statement())output.space_before_token=false;else handle_whitespace_and_comments(current_token);var next_token=get_token(1);while(flags.mode===MODE.Statement&&!(flags.if_block&&next_token&&next_token.type==="TK_RESERVED"&&next_token.text==="else")&&!flags.do_block)restore_mode();if(flags.import_block)flags.import_block=false;print_token()}function handle_string(){if(start_of_statement())output.space_before_token=true;else{handle_whitespace_and_comments(current_token);if(last_type==="TK_RESERVED"||last_type==="TK_WORD"||flags.inline_frame)output.space_before_token=true;else if(last_type==="TK_COMMA"||last_type==="TK_START_EXPR"||last_type==="TK_EQUALS"||last_type==="TK_OPERATOR"){if(!start_of_object_property())allow_wrap_or_preserved_newline()}else print_newline()}print_token()}function handle_equals(){if(start_of_statement());else handle_whitespace_and_comments(current_token);if(flags.declaration_statement)flags.declaration_assignment=true;output.space_before_token=true;print_token();output.space_before_token=true}function handle_comma(){handle_whitespace_and_comments(current_token,true);print_token();output.space_before_token=true;if(flags.declaration_statement){if(is_expression(flags.parent.mode))flags.declaration_assignment=false;if(flags.declaration_assignment){flags.declaration_assignment=false;print_newline(false,true)}else if(opt.comma_first)allow_wrap_or_preserved_newline()}else if(flags.mode===MODE.ObjectLiteral||flags.mode===MODE.Statement&&flags.parent.mode===MODE.ObjectLiteral){if(flags.mode===MODE.Statement)restore_mode();if(!flags.inline_frame)print_newline()}else if(opt.comma_first)allow_wrap_or_preserved_newline()}function handle_operator(){var isGeneratorAsterisk=current_token.text==="*"&&(last_type==="TK_RESERVED"&&in_array(flags.last_text,["function","yield"])||in_array(last_type,["TK_START_BLOCK","TK_COMMA","TK_END_BLOCK","TK_SEMICOLON"]));var isUnary=in_array(current_token.text,["-","+"])&&(in_array(last_type,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||in_array(flags.last_text,Tokenizer.line_starters)||flags.last_text===",");if(start_of_statement());else{var preserve_statement_flags=!isGeneratorAsterisk;handle_whitespace_and_comments(current_token,preserve_statement_flags)}if(last_type==="TK_RESERVED"&&is_special_word(flags.last_text)){output.space_before_token=true;print_token();return}if(current_token.text==="*"&&last_type==="TK_DOT"){print_token();return}if(current_token.text==="::"){print_token();return}if(last_type==="TK_OPERATOR"&&in_array(opt.operator_position,OPERATOR_POSITION_BEFORE_OR_PRESERVE))allow_wrap_or_preserved_newline();if(current_token.text===":"&&flags.in_case){flags.case_body=true;indent();print_token();print_newline();flags.in_case=false;return}var space_before=true;var space_after=true;var in_ternary=false;if(current_token.text===":")if(flags.ternary_depth===0)space_before=false;else{flags.ternary_depth-=1;in_ternary=true}else if(current_token.text==="?")flags.ternary_depth+=1;if(!isUnary&&!isGeneratorAsterisk&&opt.preserve_newlines&&in_array(current_token.text,Tokenizer.positionable_operators)){var isColon=current_token.text===":";var isTernaryColon=isColon&&in_ternary;var isOtherColon=isColon&&!in_ternary;switch(opt.operator_position){case OPERATOR_POSITION.before_newline:output.space_before_token=!isOtherColon;print_token();if(!isColon||isTernaryColon)allow_wrap_or_preserved_newline();output.space_before_token=true;return;case OPERATOR_POSITION.after_newline:output.space_before_token=true;if(!isColon||isTernaryColon)if(get_token(1).wanted_newline)print_newline(false,true);else allow_wrap_or_preserved_newline();else output.space_before_token=false;print_token();output.space_before_token=true;return;case OPERATOR_POSITION.preserve_newline:if(!isOtherColon)allow_wrap_or_preserved_newline();space_before=!(output.just_added_newline()||isOtherColon);output.space_before_token=space_before;print_token();output.space_before_token=true;return}}if(isGeneratorAsterisk){allow_wrap_or_preserved_newline();space_before=false;var next_token=get_token(1);space_after=next_token&&in_array(next_token.type,["TK_WORD","TK_RESERVED"])}else if(current_token.text==="..."){allow_wrap_or_preserved_newline();space_before=last_type==="TK_START_BLOCK";space_after=false}else if(in_array(current_token.text,["--","++","!","~"])||isUnary){space_before=false;space_after=false;if(current_token.wanted_newline&&(current_token.text==="--"||current_token.text==="++"))print_newline(false,true);if(flags.last_text===";"&&is_expression(flags.mode))space_before=true;if(last_type==="TK_RESERVED")space_before=true;else if(last_type==="TK_END_EXPR")space_before=!(flags.last_text==="]"&&(current_token.text==="--"||current_token.text==="++"));else if(last_type==="TK_OPERATOR"){space_before=in_array(current_token.text,["--","-","++","+"])&&in_array(flags.last_text,["--","-","++","+"]);if(in_array(current_token.text,["+","-"])&&in_array(flags.last_text,["--","++"]))space_after=true}if((flags.mode===MODE.BlockStatement&&!flags.inline_frame||flags.mode===MODE.Statement)&&(flags.last_text==="{"||flags.last_text===";"))print_newline()}output.space_before_token=output.space_before_token||space_before;print_token();output.space_before_token=space_after}function handle_block_comment(preserve_statement_flags){if(output.raw){output.add_raw_token(current_token);if(current_token.directives&&current_token.directives.preserve==="end")output.raw=opt.test_output_raw;return}if(current_token.directives){print_newline(false,preserve_statement_flags);print_token();if(current_token.directives.preserve==="start")output.raw=true;print_newline(false,true);return}if(!acorn.newline.test(current_token.text)&&!current_token.wanted_newline){output.space_before_token=true;print_token();output.space_before_token=true;return}var lines=split_linebreaks(current_token.text);var j;var javadoc=false;var starless=false;var lastIndent=current_token.whitespace_before;var lastIndentLength=lastIndent.length;print_newline(false,preserve_statement_flags);if(lines.length>1){javadoc=all_lines_start_with(lines.slice(1),"*");starless=each_line_matches_indent(lines.slice(1),lastIndent)}print_token(lines[0]);for(j=1;j<lines.length;j++){print_newline(false,true);if(javadoc)print_token(" "+ltrim(lines[j]));else if(starless&&lines[j].length>lastIndentLength)print_token(lines[j].substring(lastIndentLength));else output.add_token(lines[j])}print_newline(false,preserve_statement_flags)}function handle_comment(preserve_statement_flags){if(current_token.wanted_newline)print_newline(false,preserve_statement_flags);else output.trim(true);output.space_before_token=true;print_token();print_newline(false,preserve_statement_flags)}function handle_dot(){if(start_of_statement());else handle_whitespace_and_comments(current_token,true);if(last_type==="TK_RESERVED"&&is_special_word(flags.last_text))output.space_before_token=true;else allow_wrap_or_preserved_newline(flags.last_text===")"&&opt.break_chained_methods);print_token()}function handle_unknown(preserve_statement_flags){print_token();if(current_token.text[current_token.text.length-1]==="\n")print_newline(false,preserve_statement_flags)}function handle_eof(){while(flags.mode===MODE.Statement)restore_mode();handle_whitespace_and_comments(current_token)}}function OutputLine(parent){var _character_count=0;var _indent_count=-1;var _items=[];var _empty=true;this.set_indent=function(level){_character_count=parent.baseIndentLength+level*parent.indent_length;_indent_count=level};this.get_character_count=function(){return _character_count};this.is_empty=function(){return _empty};this.last=function(){if(!this._empty)return _items[_items.length-1];else return null};this.push=function(input){_items.push(input);_character_count+=input.length;_empty=false};this.pop=function(){var item=null;if(!_empty){item=_items.pop();_character_count-=item.length;_empty=_items.length===0}return item};this.remove_indent=function(){if(_indent_count>0){_indent_count-=1;_character_count-=parent.indent_length}};this.trim=function(){while(this.last()===" "){_items.pop();_character_count-=1}_empty=_items.length===0};this.toString=function(){var result="";if(!this._empty){if(_indent_count>=0)result=parent.indent_cache[_indent_count];result+=_items.join("")}return result}}function Output(indent_string,baseIndentString){baseIndentString=baseIndentString||"";this.indent_cache=[baseIndentString];this.baseIndentLength=baseIndentString.length;this.indent_length=indent_string.length;this.raw=false;var lines=[];this.baseIndentString=baseIndentString;this.indent_string=indent_string;this.previous_line=null;this.current_line=null;this.space_before_token=false;this.add_outputline=function(){this.previous_line=this.current_line;this.current_line=new OutputLine(this);lines.push(this.current_line)};this.add_outputline();this.get_line_number=function(){return lines.length};this.add_new_line=function(force_newline){if(this.get_line_number()===1&&this.just_added_newline())return false;if(force_newline||!this.just_added_newline()){if(!this.raw)this.add_outputline();return true}return false};this.get_code=function(){var sweet_code=lines.join("\n").replace(/[\r\n\t ]+$/,"");return sweet_code};this.set_indent=function(level){if(lines.length>1){while(level>=this.indent_cache.length)this.indent_cache.push(this.indent_cache[this.indent_cache.length-1]+this.indent_string);this.current_line.set_indent(level);return true}this.current_line.set_indent(0);return false};this.add_raw_token=function(token){for(var x=0;x<token.newlines;x++)this.add_outputline();this.current_line.push(token.whitespace_before);this.current_line.push(token.text);this.space_before_token=false};this.add_token=function(printable_token){this.add_space_before_token();this.current_line.push(printable_token)};this.add_space_before_token=function(){if(this.space_before_token&&!this.just_added_newline())this.current_line.push(" ");this.space_before_token=false};this.remove_redundant_indentation=function(frame){if(frame.multiline_frame||frame.mode===MODE.ForInitializer||frame.mode===MODE.Conditional)return;var index=frame.start_line_index;var output_length=lines.length;while(index<output_length){lines[index].remove_indent();index++}};this.trim=function(eat_newlines){eat_newlines=eat_newlines===undefined?false:eat_newlines;this.current_line.trim(indent_string,baseIndentString);while(eat_newlines&&lines.length>1&&this.current_line.is_empty()){lines.pop();this.current_line=lines[lines.length-1];this.current_line.trim()}this.previous_line=lines.length>1?lines[lines.length-2]:null};this.just_added_newline=function(){return this.current_line.is_empty()};this.just_added_blankline=function(){if(this.just_added_newline()){if(lines.length===1)return true;var line=lines[lines.length-2];return line.is_empty()}return false}}var InputScanner=function(input){var _input=input;var _input_length=_input.length;var _position=0;this.back=function(){_position-=1};this.hasNext=function(){return _position<_input_length};this.next=function(){var val=null;if(this.hasNext()){val=_input.charAt(_position);_position+=1}return val};this.peek=function(index){var val=null;index=index||0;index+=_position;if(index>=0&&index<_input_length)val=_input.charAt(index);return val};this.peekCharCode=function(index){var val=0;index=index||0;index+=_position;if(index>=0&&index<_input_length)val=_input.charCodeAt(index);return val};this.test=function(pattern,index){index=index||0;pattern.lastIndex=_position+index;return pattern.test(_input)};this.testChar=function(pattern,index){var val=this.peek(index);return val!==null&&pattern.test(val)};this.match=function(pattern){pattern.lastIndex=_position;var pattern_match=pattern.exec(_input);if(pattern_match&&pattern_match.index===_position)_position+=pattern_match[0].length;else pattern_match=null;return pattern_match}};var Token=function(type,text,newlines,whitespace_before,parent){this.type=type;this.text=text;this.comments_before=[];this.comments_after=[];this.newlines=newlines||0;this.wanted_newline=newlines>0;this.whitespace_before=whitespace_before||"";this.parent=parent||null;this.opened=null;this.directives=null};function tokenizer(input_string,opts){var whitespace="\n\r\t ".split("");var digit=/[0-9]/;var digit_bin=/[01]/;var digit_oct=/[01234567]/;var digit_hex=/[0123456789abcdefABCDEF]/;this.positionable_operators="!= !== % & && * ** + - / : < << <= == === > >= >> >>> ? ^ | ||".split(" ");var punct=this.positionable_operators.concat("! %= &= *= **= ++ += , -- -= /= :: <<= = => >>= >>>= ^= |= ~ ...".split(" "));this.line_starters="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,import,export".split(",");var reserved_words=this.line_starters.concat(["do","in","of","else","get","set","new","catch","finally","typeof","yield","async","await","from","as"]);var block_comment_pattern=/([\s\S]*?)((?:\*\/)|$)/g;var comment_pattern=/([^\n\r\u2028\u2029]*)/g;var directives_block_pattern=/\/\* beautify( \w+[:]\w+)+ \*\//g;var directive_pattern=/ (\w+)[:](\w+)/g;var directives_end_ignore_pattern=/([\s\S]*?)((?:\/\*\sbeautify\signore:end\s\*\/)|$)/g;var template_pattern=/((<\?php|<\?=)[\s\S]*?\?>)|(<%[\s\S]*?%>)/g;var n_newlines,whitespace_before_token,in_html_comment,tokens;var input;this.tokenize=function(){input=new InputScanner(input_string);in_html_comment=false;tokens=[];var next,last;var token_values;var open=null;var open_stack=[];var comments=[];while(!(last&&last.type==="TK_EOF")){token_values=tokenize_next();next=new Token(token_values[1],token_values[0],n_newlines,whitespace_before_token);while(next.type==="TK_COMMENT"||next.type==="TK_BLOCK_COMMENT"||next.type==="TK_UNKNOWN"){if(next.type==="TK_BLOCK_COMMENT")next.directives=token_values[2];comments.push(next);token_values=tokenize_next();next=new Token(token_values[1],token_values[0],n_newlines,whitespace_before_token)}if(comments.length){next.comments_before=comments;comments=[]}if(next.type==="TK_START_BLOCK"||next.type==="TK_START_EXPR"){next.parent=last;open_stack.push(open);open=next}else if((next.type==="TK_END_BLOCK"||next.type==="TK_END_EXPR")&&(open&&(next.text==="]"&&open.text==="["||next.text===")"&&open.text==="("||next.text==="}"&&open.text==="{"))){next.parent=open.parent;next.opened=open;open=open_stack.pop()}tokens.push(next);last=next}return tokens};function get_directives(text){if(!text.match(directives_block_pattern))return null;var directives={};directive_pattern.lastIndex=0;var directive_match=directive_pattern.exec(text);while(directive_match){directives[directive_match[1]]=directive_match[2];directive_match=directive_pattern.exec(text)}return directives}function tokenize_next(){var resulting_string;var whitespace_on_this_line=[];n_newlines=0;whitespace_before_token="";var c=input.next();if(c===null)return["","TK_EOF"];var last_token;if(tokens.length)last_token=tokens[tokens.length-1];else last_token=new Token("TK_START_BLOCK","{");while(in_array(c,whitespace)){if(acorn.newline.test(c)){if(!(c==="\n"&&input.peek(-2)==="\r")){n_newlines+=1;whitespace_on_this_line=[]}}else whitespace_on_this_line.push(c);c=input.next();if(c===null)return["","TK_EOF"]}if(whitespace_on_this_line.length)whitespace_before_token=whitespace_on_this_line.join("");if(digit.test(c)||c==="."&&input.testChar(digit)){var allow_decimal=true;var allow_e=true;var local_digit=digit;if(c==="0"&&input.testChar(/[XxOoBb]/)){allow_decimal=false;allow_e=false;if(input.testChar(/[Bb]/))local_digit=digit_bin;else if(input.testChar(/[Oo]/))local_digit=digit_oct;else local_digit=digit_hex;c+=input.next()}else if(c===".")allow_decimal=false;else{c="";input.back()}while(input.testChar(local_digit)){c+=input.next();if(allow_decimal&&input.peek()==="."){c+=input.next();allow_decimal=false}if(allow_e&&input.testChar(/[Ee]/)){c+=input.next();if(input.testChar(/[+-]/))c+=input.next();allow_e=false;allow_decimal=false}}return[c,"TK_WORD"]}if(acorn.isIdentifierStart(input.peekCharCode(-1))){if(input.hasNext())while(acorn.isIdentifierChar(input.peekCharCode())){c+=input.next();if(!input.hasNext())break}if(!(last_token.type==="TK_DOT"||last_token.type==="TK_RESERVED"&&in_array(last_token.text,["set","get"]))&&in_array(c,reserved_words)){if(c==="in"||c==="of")return[c,"TK_OPERATOR"];return[c,"TK_RESERVED"]}return[c,"TK_WORD"]}if(c==="("||c==="[")return[c,"TK_START_EXPR"];if(c===")"||c==="]")return[c,"TK_END_EXPR"];if(c==="{")return[c,"TK_START_BLOCK"];if(c==="}")return[c,"TK_END_BLOCK"];if(c===";")return[c,"TK_SEMICOLON"];if(c==="/"){var comment="";var comment_match;if(input.peek()==="*"){input.next();comment_match=input.match(block_comment_pattern);comment="/*"+comment_match[0];var directives=get_directives(comment);if(directives&&directives.ignore==="start"){comment_match=input.match(directives_end_ignore_pattern);comment+=comment_match[0]}comment=comment.replace(acorn.allLineBreaks,"\n");return[comment,"TK_BLOCK_COMMENT",directives]}if(input.peek()==="/"){input.next();comment_match=input.match(comment_pattern);comment="//"+comment_match[0];return[comment,"TK_COMMENT"]}}var startXmlRegExp=/<()([-a-zA-Z:0-9_.]+|{[\s\S]+?}|!\[CDATA\[[\s\S]*?\]\])(\s+{[\s\S]+?}|\s+[-a-zA-Z:0-9_.]+|\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{[\s\S]+?}))*\s*(\/?)\s*>/g;if(c==="`"||c==="'"||c==='"'||(c==="/"||opts.e4x&&c==="<"&&input.test(startXmlRegExp,-1))&&(last_token.type==="TK_RESERVED"&&in_array(last_token.text,["return","case","throw","else","do","typeof","yield"])||last_token.type==="TK_END_EXPR"&&last_token.text===")"&&last_token.parent&&last_token.parent.type==="TK_RESERVED"&&in_array(last_token.parent.text,["if","while","for"])||in_array(last_token.type,["TK_COMMENT","TK_START_EXPR","TK_START_BLOCK","TK_END_BLOCK","TK_OPERATOR","TK_EQUALS","TK_EOF","TK_SEMICOLON","TK_COMMA"]))){var sep=c,esc=false,has_char_escapes=false;resulting_string=c;if(sep==="/"){var in_char_class=false;while(input.hasNext()&&((esc||in_char_class||input.peek()!==sep)&&!input.testChar(acorn.newline))){resulting_string+=input.peek();if(!esc){esc=input.peek()==="\\";if(input.peek()==="[")in_char_class=true;else if(input.peek()==="]")in_char_class=false}else esc=false;input.next()}}else if(opts.e4x&&sep==="<"){var xmlRegExp=/[\s\S]*?<(\/?)([-a-zA-Z:0-9_.]+|{[\s\S]+?}|!\[CDATA\[[\s\S]*?\]\])(\s+{[\s\S]+?}|\s+[-a-zA-Z:0-9_.]+|\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{[\s\S]+?}))*\s*(\/?)\s*>/g;input.back();var xmlStr="";var match=input.match(startXmlRegExp);if(match){var rootTag=match[2].replace(/^{\s+/,"{").replace(/\s+}$/,"}");var isCurlyRoot=rootTag.indexOf("{")===0;var depth=0;while(match){var isEndTag=!!match[1];var tagName=match[2];var isSingletonTag=!!match[match.length-1]||tagName.slice(0,8)==="![CDATA[";if(!isSingletonTag&&(tagName===rootTag||isCurlyRoot&&tagName.replace(/^{\s+/,"{").replace(/\s+}$/,"}")))if(isEndTag)--depth;else++depth;xmlStr+=match[0];if(depth<=0)break;match=input.match(xmlRegExp)}if(!match)xmlStr+=input.match(/[\s\S]*/g)[0];xmlStr=xmlStr.replace(acorn.allLineBreaks,"\n");return[xmlStr,"TK_STRING"]}}else{var parse_string=function(delimiter,allow_unescaped_newlines,start_sub){var current_char;while(input.hasNext()){current_char=input.peek();if(!(esc||current_char!==delimiter&&(allow_unescaped_newlines||!acorn.newline.test(current_char))))break;if((esc||allow_unescaped_newlines)&&acorn.newline.test(current_char)){if(current_char==="\r"&&input.peek(1)==="\n"){input.next();current_char=input.peek()}resulting_string+="\n"}else resulting_string+=current_char;if(esc){if(current_char==="x"||current_char==="u")has_char_escapes=true;esc=false}else esc=current_char==="\\";input.next();if(start_sub&&resulting_string.indexOf(start_sub,resulting_string.length-start_sub.length)!==-1){if(delimiter==="`")parse_string("}",allow_unescaped_newlines,"`");else parse_string("`",allow_unescaped_newlines,"${");if(input.hasNext())resulting_string+=input.next()}}};if(sep==="`")parse_string("`",true,"${");else parse_string(sep)}if(has_char_escapes&&opts.unescape_strings)resulting_string=unescape_string(resulting_string);if(input.peek()===sep){resulting_string+=sep;input.next();if(sep==="/")while(input.hasNext()&&acorn.isIdentifierStart(input.peekCharCode()))resulting_string+=input.next()}return[resulting_string,"TK_STRING"]}if(c==="#"){if(tokens.length===0&&input.peek()==="!"){resulting_string=c;while(input.hasNext()&&c!=="\n"){c=input.next();resulting_string+=c}return[trim(resulting_string)+"\n","TK_UNKNOWN"]}var sharp="#";if(input.hasNext()&&input.testChar(digit)){do{c=input.next();sharp+=c}while(input.hasNext()&&c!=="#"&&c!=="=");if(c==="#");else if(input.peek()==="["&&input.peek(1)==="]"){sharp+="[]";input.next();input.next()}else if(input.peek()==="{"&&input.peek(1)==="}"){sharp+="{}";input.next();input.next()}return[sharp,"TK_WORD"]}}if(c==="<"&&(input.peek()==="?"||input.peek()==="%")){input.back();var template_match=input.match(template_pattern);if(template_match){c=template_match[0];c=c.replace(acorn.allLineBreaks,"\n");return[c,"TK_STRING"]}}if(c==="<"&&input.match(/\!--/g)){c="\x3c!--";while(input.hasNext()&&!input.testChar(acorn.newline))c+=input.next();in_html_comment=true;return[c,"TK_COMMENT"]}if(c==="-"&&in_html_comment&&input.match(/->/g)){in_html_comment=false;return["--\x3e","TK_COMMENT"]}if(c==="."){if(input.peek()==="."&&input.peek(1)==="."){c+=input.next()+input.next();return[c,"TK_OPERATOR"]}return[c,"TK_DOT"]}if(in_array(c,punct)){while(input.hasNext()&&in_array(c+input.peek(),punct)){c+=input.next();if(!input.hasNext())break}if(c===",")return[c,"TK_COMMA"];else if(c==="=")return[c,"TK_EQUALS"];else return[c,"TK_OPERATOR"]}return[c,"TK_UNKNOWN"]}function unescape_string(s){var out="",escaped=0;var input_scan=new InputScanner(s);var matched=null;while(input_scan.hasNext()){matched=input_scan.match(/([\s]|[^\\]|\\\\)+/g);if(matched)out+=matched[0];if(input_scan.peek()==="\\"){input_scan.next();if(input_scan.peek()==="x")matched=input_scan.match(/x([0-9A-Fa-f]{2})/g);else if(input_scan.peek()==="u")matched=input_scan.match(/u([0-9A-Fa-f]{4})/g);else{out+="\\";if(input_scan.hasNext())out+=input_scan.next();continue}if(!matched)return s;escaped=parseInt(matched[1],16);if(escaped>126&&escaped<=255&&matched[0].indexOf("x")===0)return s;else if(escaped>=0&&escaped<32){out+="\\"+matched[0];continue}else if(escaped===34||escaped===39||escaped===92)out+="\\"+String.fromCharCode(escaped);else out+=String.fromCharCode(escaped)}}return out}}var beautifier=new Beautifier(js_source_text,options);return beautifier.beautify()}if(typeof define==="function"&&define.amd)define([],function(){return{js_beautify:js_beautify}});else if(typeof exports!=="undefined")exports.js_beautify=js_beautify;else if(typeof window!=="undefined")window.js_beautify=js_beautify;else if(typeof global!=="undefined")global.js_beautify=js_beautify})()}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],"js-beautify":[function(require,module,exports){function get_beautify(js_beautify,css_beautify,html_beautify){var beautify=function(src,config){return js_beautify.js_beautify(src,config)};beautify.js=js_beautify.js_beautify;beautify.css=css_beautify.css_beautify;beautify.html=html_beautify.html_beautify;beautify.js_beautify=js_beautify.js_beautify;beautify.css_beautify=css_beautify.css_beautify;beautify.html_beautify=html_beautify.html_beautify;return beautify}if(typeof define==="function"&&define.amd)define(["./lib/beautify","./lib/beautify-css","./lib/beautify-html"],function(js_beautify,css_beautify,html_beautify){return get_beautify(js_beautify,css_beautify,html_beautify)});else(function(mod){var js_beautify=require("./lib/beautify");var css_beautify=require("./lib/beautify-css");var html_beautify=require("./lib/beautify-html");mod.exports=get_beautify(js_beautify,css_beautify,html_beautify)})(module)},{"./lib/beautify":3,"./lib/beautify-css":1,"./lib/beautify-html":2}]},{},[]);return require("js-beautify").js_beautify}();

function findCodeEditor() {
  var templates =
  utui.customizations_template;
  var container = $("h3.ui-state-active").closest(".customize_container");
  var extension_id = container.data().id;
  var template_id = container.attr("data-template-id");
  var template = templates[template_id];
  if (template && template.editor) return template.editor[extension_id]
}
var jsb_config = {
  "indent_size": 2,
  "indent_char": " ",
  "indent_with_tabs": false,
  "eol": "\n",
  "end_with_newline": false,
  "indent_level": 0,
  "preserve_newlines": true,
  "max_preserve_newlines": 10,
  "space_in_paren": false,
  "space_in_empty_paren": false,
  "jslint_happy": false,
  "space_after_anon_function": false,
  "brace_style": "collapse",
  "break_chained_methods": false,
  "keep_array_indentation": false,
  "unescape_strings": false,
  "wrap_line_length": 0,
  "e4x": false,
  "comma_first": false,
  "operator_position": "before-newline"
};
var codeEditor = findCodeEditor();
if (!codeEditor) return;
codeEditor.getCode = function() {
  return this.getValue()
};
codeEditor.getJSBeautifulCode = function(code) {
  code = code || codeEditor.getCode();
  return jsb(code, {
    "indent_size": 2,
    "indent_char": " ",
    "indent_with_tabs": false,
    "eol": "\n",
    "end_with_newline": false,
    "indent_level": 0,
    "preserve_newlines": false,
    "max_preserve_newlines": 0,
    "space_in_paren": false,
    "space_in_empty_paren": false,
    "jslint_happy": false,
    "space_after_anon_function": false,
    "brace_style": "collapse",
    "break_chained_methods": false,
    "keep_array_indentation": false,
    "unescape_strings": false,
    "wrap_line_length": 0,
    "e4x": false,
    "comma_first": false,
    "operator_position": "before-newline"
  })
};
codeEditor.setJSBeautifulCode = function() {
  codeEditor.setValue(codeEditor.getJSBeautifulCode())
};
codeEditor.getClosureCompiledCode = function(code) {
  code = code || this.getCode();
  if (!code) return;

  function makeAJAXRequest(data) {
    if (!data) return;
    return $.ajax({
      url: "https://closure-compiler.appspot.com/compile",
      type: "POST",
      async: true,
      data: {
        js_code: data,
        compilation_level: "WHITESPACE_ONLY",
        output_format: "text",
        output_info: "compiled_code"
      },
      accepts: {
        "*": "*/*",
        text: "text/plain",
        html: "text/html",
        xml: "application/xml, text/xml",
        json: "application/json, text/javascript"
      },
      cache: true,
      headers: {
        "Content-type": "application/x-www-form-urlencoded"
      }
    })
  }
  var req = makeAJAXRequest(code);
  req.done(function(data) {
    return data
  });
  return req
};
codeEditor.setMinifiedCode = function(code) {
  if (!code) code = this.getCode();
  var req = this.getClosureCompiledCode(code);
  req.done(function(data) {
    codeEditor.setValue(data)
  })
};
return codeEditor
}

function saveTemplate(data, type) {
  var id, title, curr_date;
  data = data || utui.adminlib.editor.getValue();
  if (csm.dateFormat) curr_date = (csm.dateFormat("isoDate").replace(/-/igm, "") + "-" + csm.dateFormat("shortTime")).replace(/ |:/igm, "");
  if (type === "tag") {
    id = $("#manage_content").find(".ui-accordion-content-active").get(0).parentNode.dataset.id;
    if (id) title = utui.data.manage[id].title
  } else if (type === "extension") {
    id = $("h3.ui-state-active").closest(".customize_container").data().id;
    if (id) title = utui.data.customizations[49].title
  }
var label = curr_date + "." + utui.profile.lastAccount + "." + utui.profile.lastProfile + ".UID:" + id + "." + title + ".js";
console.save(data, label)
}

function addPrettyPrint() {
  if (!$("#customize_prettyPrint").length) {
    var classname = "btn tmui";
    var buttonText = "Pretty Print";
    $('<span id="customize_prettyPrint" class="' + classname + '"><i class="icon-wrench"></i> ' +
      buttonText + "</span>").css("float", "left").css("margin-left", "10px").click(function(e) {
        code_editor = getCodeEditor();
        if (code_editor) code_editor.setJSBeautifulCode()
      }).appendTo("#tabs-customizations .config_button_nofloat")
    }
  }

  function addSaveExtension() {
    if (!$("#customize_saveExtension").length) {
      var classname = "btn tmui";
      var buttonText = "save Extension";
      $('<span id="customize_saveExtension" class="' + classname + '"><i class="icon-wrench"></i> ' + buttonText + "</span>").css("float", "left").css("margin-left", "10px").click(function(e) {
        code_editor =
        getCodeEditor();
        if (code_editor) {
          var data = code_editor.getValue();
          if (data) save_template(data, "extension")
        }
    }).appendTo("#tabs-customizations .config_button_nofloat")
    }
  }
  exp.saveTemplate = saveTemplate;
  exp.addPrettyPrint = addPrettyPrint;
  exp.addSaveExtension = addSaveExtension;
  return exp
})(csm);
